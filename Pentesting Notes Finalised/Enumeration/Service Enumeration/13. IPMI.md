Important ports: UDP 623
# IPMI

- Intelligent Platform Management Interface (IPMI)
- Gives administrators remote hardware-level control and monitoring independent of host OS - power on/off, hardware sensors, remote console...
	- Via dedicated Baseboard Management Controller (BMC)
		- BMCs usually built into many motherboards, but can also be added to system as a PCI card
		- Servers either come with BMC or support adding a BMC
	- If can access BMC, gain full access to host motherboard. Can monitor, reboot, power off, reinstall host OS...


Footprinting
- Nmap
	- `sudo nmap -sU --script ipmi-version -p 623 ip
- Metasploit
	- `use auxiliary/scanner/ipmi/ipmi_version` 


BMCs with default passwords:

|Product|Username|Password|
|---|---|---|
|Dell iDRAC|root|calvin|
|HP iLO|Administrator|randomized 8-character string consisting of numbers and uppercase letters|
|Supermicro IPMI|ADMIN|ADMIN|


Dangerous settings
- flaw in the RAKP protocol in IMPI 2.0
- during authentication, server sends a salted SHA1/MD5 hash of user's pw to client before authentication takes place
- can be leveraged to obtain the pw hash for ANY valid user account on BMC
- hashes can then be cracked using dictionary attack
	- **Hashcat, mode 7300**
- HP iLO using default factory password
	- `hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u 
		- Tries all combinations of upper case letters and numbers for an eight-character password

Importance
- Can gain access to BMC web console 
- Instances where password is later re-used in other systems

Retrieving IMPI hashes
- Metasploit IPMI 2.0 RAKP Remote SHA1 Password Hash Retrieval
- `use auxiliary/scanner/ipmi/ipmi_dumphashes 
	- Note: experiment with different word lists
