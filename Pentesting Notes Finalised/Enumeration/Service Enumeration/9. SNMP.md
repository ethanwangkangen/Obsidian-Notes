Important ports: 161 (UDP), 162(UDP)

# Simple Network Management Protocol
- Used for monitoring and managing network devices (routers, switches, printers, server/)

- MIB
	- Management Information Base
	- Format for storing device info
	- Text file, where all queryable SNMP objects of a device are listed in a tree hierarchy
	- At least one Object Identifier (OID), which provides necessary unique address and name, and also other info 
		- Each OID is a node in hierarchical namespace
- SNMP Versions
	- SNMPv1 - No built in authentication
		- No encryption support
	- SNMPv2
		- The community string that provides security is only transmitted in plain text, thus no built-in encryption
	- SNMPv3
		- Authentication with username and password
		- Transmission encryption with pre-shared key
- Community strings
	- Can be seen as passwords, determining if requested info can be seen 

# Enumeration
1. Nmap
	- `sudo nmap -sU -p 161 --script=snmp* <IP>
2. Community String Brute-Force
	- ``sudo apt install onesixtyone && onesixtyone -c /opt/useful/SecLists/Discovery/SNMP/snmp.txt <IP>`
	- `snmp-check -t <IP>`
	- `nmap -sU -p161 --script=snmp-brute <IP>
3. Enumerate with found community strings
	- `snmpwalk -v2c -c public <IP>
		- walk through the entire MIB tree
	- `snmpwalk -v2c -c public <IP> 1.3.6.1.2.1.1
		- query specific OID
	- `sudo apt install braa && braa <community string> @<IP>:.1.3.6.*`

| Protocol / Tool                  | Command / Syntax                                                                    | Purpose / Notes                                                           |
| -------------------------------- | ----------------------------------------------------------------------------------- | ------------------------------------------------------------------------- |
| **snmpwalk**                     | `snmpwalk -v2c -c public <IP>`                                                      | Enumerate all OIDs with community string (`public` here).                 |
| **snmpwalk (specific OID)**      | `snmpwalk -v2c -c public <IP> <OID>`                                                | Walk a specific subtree (e.g., `.1.3.6.1.2.1.1` for system info).         |
| **snmpget**                      | `snmpget -v2c -c public <IP> <OID>`                                                 | Query a single OID instead of walking the tree.                           |
| **snmp-check**                   | `snmp-check <IP>`                                                                   | Automated enumeration of common OIDs (system, processes, services, etc.). |
| **onesixtyone**                  | `onesixtyone -c <wordlist> <IP>`                                                    | Brute-force SNMP community strings.                                       |
| **onesixtyone (quick scan)**     | `onesixtyone -c /opt/seclists/Discovery/SNMP/snmp.txt <IP>`                         | Use SecLists wordlist to discover valid SNMP community strings.           |
| **braa**                         | `braa <community>@<IP>:.1.3.6.*`                                                    | Bruteforce enumerate OIDs from SNMP host. Very fast but noisy.            |
| **snmpbulkwalk**                 | `snmpbulkwalk -v2c -c public <IP>`                                                  | More efficient than snmpwalk for retrieving large amounts of data.        |
| **snmpgetnext**                  | `snmpgetnext -v2c -c public <IP> <OID>`                                             | Get the next OID in the MIB tree after the one specified.                 |
| **snmptranslate**                | `snmptranslate -Tp`                                                                 | Show MIB tree to understand available OIDs.                               |
| **snmptranslate (specific OID)** | `snmptranslate -On <OID>`                                                           | Convert between OID names and numbers.                                    |
| **snmpwalk (with auth)**         | `snmpwalk -v3 -u <user> -A <authpass> -a MD5 -X <privpass> -x DES -l authPriv <IP>` | SNMPv3 query with authentication & encryption.                            |
| **snmp-check (service enum)**    | `snmp-check -p 161 <IP>`                                                            | Quick system & service fingerprinting over SNMP.                          |

# Useful OIDs
| OID                       | Description                                  |
| ------------------------- | -------------------------------------------- |
| `.1.3.6.1.2.1.1`          | System info (hostname, description, uptime). |
| `.1.3.6.1.2.1.25.1.6.0`   | System processes.                            |
| `.1.3.6.1.2.1.25.4.2.1.2` | Running processesâ€™ names.                    |
| `.1.3.6.1.2.1.25.4.2.1.4` | Executable paths.                            |
| `.1.3.6.1.2.1.25.6.3.1.2` | Installed software.                          |
| `.1.3.6.1.4.1.77.1.2.25`  | Windows users.                               |
| `.1.3.6.1.2.1.6.13.1.3`   | Listening TCP ports.                         |
Default config
- `cat /etc/snmp/snmpd.conf | grep -v "#" | sed -r '/^\s*$/d'`

Dangerous settings

| **Settings**                                     | **Description**                                                                       |
| ------------------------------------------------ | ------------------------------------------------------------------------------------- |
| `rwuser noauth`                                  | Provides access to the full OID tree without authentication.                          |
| `rwcommunity <community string> <IPv4 address>`  | Provides access to the full OID tree regardless of where the requests were sent from. |
| `rwcommunity6 <community string> <IPv6 address>` | Same access as with `rwcommunity` with the difference of using IPv6.                  |