# Nmap
```
Quick scan:
sudo nmap $IP -sC -sV -vv -oN nmap.final 


Full scan:
sudo nmap -p  $(nmap -p- $IP -sS -T4 | grep "open" | awk -F'/' '{print $1}' | tr '\n' ',' ) $IP -A -oN nmap.final

UDP scan
sudo nmap -sU

```


# Web Enumeration
- Add host to `/etc/hosts`
- Scan webpage for additional subdomains to add to `/etc/hosts`
	- eg. email addresses,..
- Take note of file extensions
	- eg. `.php`
- View web source, look at comments for credentials, internal paths, TODOs
- Look for forms, upload features, search bars, login panels, admin portals
- Wappalyzer for technologies
- Check `/robots.txt, /sitemap.xml, /crossdomain.xml, /cclientaccesspolicy.xml`

## VHost Enumeration
- Add found subdomains into /etc/hosts and continue with subdirectory enumeration
```
gobuster vhost -u http://<target_IP_address> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain

ffuf -u http://10.10.11.11 -H "Host: FUZZ.<address>" -w /opt/SecLists/Discovery/DNS/subdomains-top1million-20000.txt -mc all -ac
```

## Subdirectory Enumeration
- take note of error pages as well! Might have info on technologies used
``` 
feroxbuster http://<target_IP_address>
- If we know the site is PHP, add `-x php`
- Can try `-x php, txt, html, bak -k`

gobuster dir -u https://sub.example.com -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

- Consider technologies used and do targeted wordlist enumeration
	- Eg. springboot

## Parameter discovery
- When find search page/ID parameter/Download function
- Check 
	- `?id=1`, `?page=`, `?file=`, `?path=`, `?url=`, `??redirect`
- Fuzzing
	- GET
		- `ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx
	- POST
		- `ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx
	- Value Fuzzing
		- `for i in $(seq 1 1000); do echo $i >> ids.txt; done`
		- `ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx

`
## Content Management System
- If Wordpress,
	- `wpdscan --url http://target`
	- Enumerate plugins, themes, users
- If Joomla/Drupal,
	- Identify version and search for exploits
- Look for the kind of subdirectories that are used by these technologies
	- eg. for Joomla, /administrator
	- Google, eg. 'how to find version for Joomla'

## Web Framework
- Eg. SpringBoot for Java, Django/Flask for Python, Laravel/CodeIgniter for PHP, Express.js for JS, ASP.NET Core for .NEt

## Login Page
- Search for default creds for that technology
- Try `admin:admin`
- Check source page for version, search version for CVE on google and searchsploit

## CVE searching
- Google
- Searchsploit 
- Search for the **fix** as well, from the fix date.
# Web exploitation
- LFI, RFI, SQLi, Command Injection, IDOR

## PHP App
- Most common way to get a shell is with plugin/editing a template
## File upload/editing
- Try to add a PHP reverse shell for example
- Listen on attacker machine with `nc -lvnp <port>`
- Bypassing filters
	- Try changing case, eg. pHp
	- If server checks file extensions, eg. only allows .jpg or .png, try
		- Double extension, `shell.php.jpg` or `shell.php.png`
		- See if validation is only front end, then bypass with burp
		- Rename to `.phtml` or `.php5`
- Double encoding
- Navigate to location to execute shell
	- If it's error.php, try going somewhere that doesnt exist

## LFI

## Command Injection

## IDOR