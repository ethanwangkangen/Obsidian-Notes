Nmap
22/tcp    open  ssh
80/tcp    open  http
1883/tcp  open  mqtt
5672/tcp  open  amqp
8161/tcp  open  patrol-snmp
39475/tcp open  unknown
61613/tcp open  unknown
61614/tcp open  unknown
61616/tcp open  unknown

```
22/tcp    open  ssh        OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)                                         
| ssh-hostkey:                                                                                                                  
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)                                                                 
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)                                                               
80/tcp    open  http       nginx 1.18.0 (Ubuntu)                                                                                
|_http-server-header: nginx/1.18.0 (Ubuntu)                                                                                     
|_http-title: Error 401 Unauthorized                                                                                            
| http-auth:                                                                                                                    
| HTTP/1.1 401 Unauthorized\x0D                                                                                                 
|_  basic realm=ActiveMQRealm                                                                                                   
1883/tcp  open  mqtt                                                                                                            
| mqtt-subscribe:                                                                                                               
|   Topics and their most recent payloads:                                                                                      
|_    ActiveMQ/Advisory/Consumer/Topic/#:                                                                                       
5672/tcp  open  amqp?                                                                                                           
|_amqp-info: ERROR: AQMP:handshake expected header (1) frame, but was 65                                                        
| fingerprint-strings:                                                                                                          
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GetRequest, HTTPOptions, RPCCheck, RTSPRequest, SSLSessionReq, TerminalServerCook
ie:                                                                                                                             
|     AMQP                                                                                                                      
|     AMQP                                                                                                                      
|     amqp:decode-error                                                                                                         
|_    7Connection from client using unsupported AMQP attempted                                                                  
8161/tcp  open  http       Jetty 9.4.39.v20210325                                                                               
| http-auth:                                                                                                                    
| HTTP/1.1 401 Unauthorized\x0D                                                                                                 
|_  basic realm=ActiveMQRealm                                                                                                   
|_http-server-header: Jetty(9.4.39.v20210325)                      ┌────────0 (%0)────────┐                                     
|_http-title: Error 401 Unauthorized                               │ Go To Top        (<) │                                     
39475/tcp open  tcpwrapped                                         │ Go To Bottom     (>) │                                     
61613/tcp open  stomp      Apache ActiveMQ                         ├──────────────────────┤                                     
| fingerprint-strings:                                             │ Copy Line        (l) │                                     
|   HELP4STOMP:                                                    ├──────────────────────┤                                     
|     ERROR                                                        │ Horizontal Split (h) │                                     
|     content-type:text/plain                                      │ Vertical Split   (v) │                                     
|     message:Unknown STOMP action: HELP                           ├──────────────────────┤                                     
|     org.apache.activemq.transport.stomp.ProtocolException: Unknow│ Swap Up              │                                     
|     org.apache.activemq.transport.stomp.ProtocolConverter.onStomp│ Swap Down            │r.java:258)                          
|     org.apache.activemq.transport.stomp.StompTransportFilter.onCo│ Swap Marked          │er.java:85)                          
|     org.apache.activemq.transport.TransportSupport.doConsume(Tran├──────────────────────┤                                     
|     org.apache.activemq.transport.tcp.TcpTransport.doRun(TcpTrans│ Kill             (X) │
|     org.apache.activemq.transport.tcp.TcpTransport.run(TcpTranspo│ Respawn          (R) │
|_    java.lang.Thread.run(Thread.java:750)        
61614/tcp open  http       Jetty 9.4.39.v20210325                                                                               
|_http-server-header: Jetty(9.4.39.v20210325)                                                                                   
| http-methods:                                                                                                                 
|find / -perm -4000 2>/dev/null_  Potentially risky methods: TRACE                                                                                            
|_http-title: Site doesn't have a title.                                                                                        
61616/tcp open  apachemq   ActiveMQ OpenWire transport 5.15.15                       
```

Web enumeration
- port 80 http server: need credentials
	- same for port 8161
	- 6164 gives nothing
- port 61616
	- Check version and search for cve - found!
	- Downloaded POC from github and exploited
		- **Remember to change IP and port to own host and start a listener to catch the shell!**

PrivEsc
- Looking at suid binaries
	- A lot! Eg. even `sudo`
	- However, don't even have password for this account, so can't run anything
- sudo -l
	- Can run /usr/sbin/nginx as sudo 
	- Make a new config file in /tmp, then 