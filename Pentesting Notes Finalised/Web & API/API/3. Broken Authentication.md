# Improper Restriction of Excessive Authentication Attempts
- Essentially, **brute forcing passwords** - no rate limiting..
- eg.
	- Given `htbpentester3@hackthebox.com:HTBPentester3` credentials
	- Account belongs to customer, so use `/api/v1/authentication/customers/sign-in` endpoint to get JWT then authenciate with it
	- With the JWT, get info on user with `/api/v1/customers/current-user` endpoint
		- See 3 roles: `Customers_UpdateByCurrentUser, Customers_Get, and Customers_GetAll`
	- Try `/api/v1/customers` endpoints, can use with `Customers_GetAll`
		- Returns records of all customers
		- Broken Object Property Level Authorization (covered later)
	- Try `/api/v1/customers/current-user PATCH`
		- Try with a weak password -> see the response -> Password must be at least 6 characters long -> this is brute-forcable
	- Brute force against other customers using ffuf
	1. Get the fail message that `/api/v1/authentication/customers/sign-in` gives with incorrect credentials
	2. Prepare userlist (pre-prepped)
	3. fuzz/brute force login with ffuf 
		- `ffuf -w /opt/useful/seclists/Passwords/xato-net-10-million-passwords-10000.txt:PASS -w customerEmails.txt:EMAIL -u http://94.237.59.63:31874/api/v1/authentication/customers/sign-in -X POST -H "Content-Type: application/json" -d '{"Email": "EMAIL", "Password": "PASS"}' -fr "Invalid Credentials" -t 100`
		- Fuzzing both username and password at same time, so need 2 keywords, PASS ans EMAIL wordlists
	4. Using password, signin with `/api/v1/authentication/customers/sign-in` endpoint, get JWT and use JWT to get confidential information

Mitigation
- Rate limiting to prevent brute force
- Robust password policy

