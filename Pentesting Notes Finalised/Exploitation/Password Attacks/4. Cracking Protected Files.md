Searching for encrypted files in Linux
- `for ext in $(echo ".xls .xls* .xltx .od* .doc .doc* .pdf .pot .pot* .pp*");do echo -e "\nFile extension: " $ext; find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done`

Searching for SSH keys
- `grep -rnE '^\-{5}BEGIN [A-Z0-9]+ PRIVATE KEY\-{5}$' /* 2>/dev/null
- Some older SSH keys are encrypted
	- Can tell by reading with ssh-keygen
		- `ssh-keygen -yf ~/.ssh/id_ed25519 
			- Will prompt for passphrase

Cracking encrypted SSH keys
1. Find where the script is
	- `locate ssh2john.py`
2. Get the hash first before using JtR to crack
	- `ssh2john.py SSH.private > ssh.hash`
3. Crack the hash
	- `john --wordlist=rockyou.txt ssh.sh`
4. Show the result
	- `john ssh.hash --show`

Cracking password-protected documents
- Same procedure as previously
1. Get the hash
	- `office2john.py Protected.docx > protected-docx.hash`
2. Crack the hash
	- `john --wordlist=rockyou.txt protected-docx.hash`
3. Show the result
	- `john protected-docx.hash --show

Cracking PDFs
- Same as before, swap office2johnw ith pdf2john.py
`

# Cracking protected archives
Cracking Zip files
1. Get the hash
	- zip2john Zip.zip > zip.hash
2. Crack the hash
	- `john --wordlist=rockyou.txt zip.hash`
3. Show the result
	- `john zip.hash --show`

Cracking OpenSSL encrypted Gzip
- to identify actual format of file
	- `file` command
- `for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null| tar xz;done
	- will output in a newly extracted file
	- `ls

Cracking Bitlocker-encrypted files
- use bitlocker2john to 4 different hashes
	- first 2 correspond to Bitlocker password
	- latter 2 correspond to recovery key
		- long, not practical guess
		- thus focus on cracking password using first hash (`$bitlocker$0$..`)
1. Get the hash(es)
	- `bitlocker2john -i Backup.vhd > backup.hashes`
2. Focus on the first hash (corresponding to password)
	- `grep "bitlocker\$0" backup.hashes > backup.hash`
3. Try and crack the password hash
	- `hashcat -a 0 -m 22100 <the output in backup.hash> /usr/share/wordlists/rockyou.txt

Mounting Bitlocker-encrypted drives in windows
- double click the .vhd file
- then after the initial error, double click the bitlocker volume to be prompted for password

Mounting Bitlocker-encrypted drives in Linux
1. Install dislocker
	- `sudo apt-get install dislocker`
2. 2 Folders to mount the VHD
	- `sudo mkdir -p /media/bitlocker`
	- `sudo mkdir -p /media/bitlockermount`
3. Configure the VHD a a loop device
	- `sudo losetup -f -P Backup.vhd`
4. Decrypt the drive with dislocker
	- `sudo dislocker /dev/loop0p2 -u1234qwer -- /media/bitlocker`
5. Mount the decrypted volume
	- `sudo mount -o loop /media/bitlocker/dislocker-file /media/bitlockermount
6. Browse the files
	- `cd /media/bitlockermount/`


`