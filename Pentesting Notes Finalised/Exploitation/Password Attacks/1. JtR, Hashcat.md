
# Hashing
- `echo -n Soccer06! | md5sum`
- `echo -n Soccer06! | sha256sum`

Rainbow tables
- Map  of common passwords to hashes
- Solution: salting


# Identifying hash formats
- `hashid -j <hash>`
	- `-j` to also show the JtR (John the Ripper) format
	- `-m` for hashcat hash type

# John the rippper

## Cracking modes
- Single crack mode
	- Most useful for Linux creds
	- Generates password candidates based on victim's username, home directory name, GECOS values
	- eg. 
		- file called `passwd` that contains info on user
			- `r0lf:$6$ues25dIanlctrWxg$nZHVz2z4kCy1760Ee28M1xtHdGoy0C2cYzZ8l2sVa1kIa8K9gAcdBP.GI6ng/qA4oaMrgElZ1Cb9OeXO4Fvy3/:0:0:Rolf Sebastian:/home/r0lf:/bin/bash`
		- `john --single passwrd`
- Wordlist mode
	- `john --wordlist=<wordlist_file> <hash_file>`
- Incremental mode
	- Based on statistical model
	- `john --incremental <hash file>`
		- `--incremental=Alpha` - only letters
		- `--incremental=Digits` - only numbers
		- `--incremental=ASCII` - all ASCII characters(default)
		- `--format=NT`
			- raw-md5, raw-sha1, raw-sha256, nt, lm, etc.
				- to see all, use `john --list=formats`
	
	- Much slower, use for 4-8 character passwrods/numeric PINs, or on hashes with fast algorithms (eg. NTLM, MD5)
- Show results
	- `john --show hashes.txt`

## Cracking files
- Can also crack password protected/encrypted files with JtR
- `<tool> <file_to_crack> > file.hash
- to see the tools,
	- ``locate *2john*
	- eg. bitlocker2john, ....


# Hashcat
- `hashcat -a 0 -m 0 <hashes> [wordlist, rule, mask, ...]`
	- `-a`: attack mode
	- `-m`: hash type
	- `<hashes>`: hash string/file containing one or more password hashes of same type
- also show with `hashcat --show hash.txt

## Hash Types
- `hashcat --help`
	- see hash modes

## Attack modes
- Dictionary attack
	- `-a 0`
	- brute force with wordlist
	- eg. `hashcat -a 0 -m 0 <hash> /usr/share/wordlists/rockyou.txt
	- rules can be used to perform specific modiifcations to passwords
		- ` ls -l /usr/share/hashcat/rules`
- Mask attack
	-  `a 3`
	- brute force, keyspace defined by user
	- eg. we know a password is 8 characters long, can define a mask that tests combination of 6 letters followed by 2 numbers
	- `hashcat -a 3 -m 0 <hash> '?l?l?l?l?l?l?d?d'`
	- mask is defined by combining sequence of symbols

In built character sets:

| Symbol | Charset                             |
| ------ | ----------------------------------- |
| ?l     | abcdefghijklmnopqrstuvwxyz          |
| ?u     | ABCDEFGHIJKLMNOPQRSTUVWXYZ          |
| ?d     | 0123456789                          |
| ?h     | 0123456789abcdef                    |
| ?H     | 0123456789ABCDEF                    |
| ?s     | «space»!"#$%&'()*+,-./:;<=>?@[]^_`{ |
| ?a     | ?l?u?d?s                            |
| ?b     | 0x00 - 0xff                         |
- custom chracter sets can be defined with -1, -2, -3, -4 arguments and referred to with ?1, ?2, ?3, ?4

## Custom wordlists
Can use hashcat to combine lists of potential names and labels with specific mutation rules to create cusotm wordlists

|**Function**|**Description**|
|---|---|
|`:`|Do nothing|
|`l`|Lowercase all letters|
|`u`|Uppercase all letters|
|`c`|Capitalize the first letter and lowercase others|
|`sXY`|Replace all instances of X with Y|
|`$!`|Add the exclamation character at the end|

1. Define a rule list
eg.
```c
vim custom.rule
:
c
so0
c so0
sa@
c sa@
c sa@ so0
$!
$! c
$! so0
$! sa@
$! c so0
$! c sa@
$! so0 sa@
$! c so0 sa@
```
- Hashcat and JtR come with pre-built rule lists
	- Common one: `best64.rule
`
2. Use this list to apply to each word in password list
	- `hashcat --force password.list -r custom.rule --stdout | sort -u > mut_password.list`
		- `-r` : use the custom rule set
		- `--stdout`: just a generator

3. Then try to bruteforce with the generated list
	- `hashcat -m <mode> -a 0 hash.txt mut_password.list  --outfile=cracked.txt


## Generating combinations from seed
- Take all clues and put into seeds.txt

Doubles
```c
# pairwise combos
while read a; do
  while read b; do
    echo "${a}${b}"
  done < seeds.txt
done < seeds.txt > combos.txt
sort -u combos.txt > combos.u.txt
```

Triples
```c
while read a; do
  while read b; do
    while read c; do
      echo "${a}${b}${c}"
    done < seeds.txt
  done < seeds.txt
done < seeds.txt > combos_triples.txt

```

Python script for both
```c
python3 - <<'PY'
from itertools import product
seeds = [s.strip() for s in open('seeds.txt')]
# pairs
with open('combos_pairs.txt','w') as f:
    for a,b in product(seeds, repeat=2):
        f.write(a+b+"\n")
# triples
with open('combos_triples.txt','w') as f:
    for a,b,c in product(seeds, repeat=3):
        f.write(a+b+c+"\n")
PY
sort -u combos_pairs.txt > combos_pairs.u.txt

```
# Generating wordlists from Website
- `cewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist