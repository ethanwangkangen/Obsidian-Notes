Use case
- Connecting to a Windows host with a Windows machine as pivot
![[88.png]]

- Pivot machine listens and forwards requests to the other WIndows internal machine
	- Basically, direct port forwarding

After gaining access to the pivot machine, run this on pivot
- `C:\Windows\system32> netsh.exe interface portproxy add v4tov4 listenport=8080 listenaddress=10.129.15.150 connectport=3389 connectaddress=172.16.5.25`
	- listenaddress, 10.129.15.150 is external IP of pivot machine
		- The network interface IP which the Windows host will accept incoming connections on
	- connectaddress, 172.16.5.25 is internal IP of the internal windows machine
	- Listens on port 8080 and forwards to internal server's port 3389

```
Attack Host
 ↓
10.129.15.150:8080   (Windows 10 pivot listening)
 ↓
netsh portproxy
 ↓
172.16.5.25:3389    (Internal Windows Server / DC)
```

To verify the port forward:
- `C:\Windows\system32> netsh.exe interface portproxy show v4tov4`

Then can RDP into the internal Windows machine by connecting to port 8080 on the pivot
- `xfreerdp3 /v:<pivot_ip>:8080 /u:... /p:...`

