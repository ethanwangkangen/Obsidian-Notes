# DNS Zone transfer
- `dig AXFR @ns1.inlanefreight.htb inlanefreight.htb`
- Can use Fierce to enumerate all DNS servers of root domain, scan for DNS zone transfer
	- `fierce --domain zonetransfer.me

# Domain Takeover
- Registering a non-existent domain name to gain control over another domain
- Also possible with subdomains, ie. subdomain takeover
	- DNS' canonical name (CNAME) record used to map domains to parent domain
	- eg. domain name sub.target.com uses CNAME record to another domain (anotherdomain.com)
		- `sub.target.com.   60   IN   CNAME   anotherdomain.com`
		- so sub.target.com's record points to A/AAAA for another domain.com to get the IP
			- Effectively they share the IP
			- However, this is only at DNS resultion level, NO web redirect (browser address stays at sub.target.com) and NO content switch automatically (web server must be configured to serve the Host: sub.target.com virtual host)
		- If anotherdomain.com expires, anyone able to claim, then anyone who registers it will have complete control over sub.target.com
			- Attacker registers anotherdomain.com -> Own IP
			- Anyone who goes to sub.target.com will now go to attacker's IP

## Subdomain Enumeration
- Subfinder
	- `./subfinder -d inlanefreight.com -v    `
- Subbrute
	- `git clone https://github.com/TheRook/subbrute.git >> /dev/null 2>&1`
	- `cd subbrute`
	- `echo "ns1.inlanefreight.com" > ./resolvers.txt`
	- `./subbrute.py inlanefreight.com -s ./names.txt -r ./resolvers.txt`

Then, try to find the CNAME records for those subdomains found
- `host <domain name>`
- `nslookup <domain>`
- eg. support.inlanefreight is an alias for inlanefreight.s3.amazonaws.com
	- Then search https://support.inlanefreight.com
	- See NoSuchBucket error
		- Can takeover subdomain by creating AWS S3 bucket with same subdomain name
- https://github.com/EdOverflow/can-i-take-over-xyz

# DNS Spoofing/DNS Cache poisoning
- Can intercept communication between a user and DNS server (MITM) attack
- Or can exploit vulnerability found in DNS server, control server to modify records
- https://www.ettercap-project.org/
