
# How to determine Host OS is Windows?
- ping machine
	- check ttl: 128 for Windows
	- https://subinsb.com/default-device-ttl-values/
- nmap with OS detection flag

# Payload for Windows machine

## Payload types
- Dynamic Linking Library (DLL)
	- library file used by Microsoft OS to share code/data that can be used by many programs at once
- Batch
	- .bat
	- utilised by system administrators to complete multiple tasks through CLI
- VBS
	- VBScript is lightweight scripting language based on Microsoft's Visual Basic
- MSI
	- installation database for Windows installer
	- run `msiexec to execute file
- Powershell
	- both a shell environment and scripting language

## Payload generation
- MSFVenom and Metasploit
- Payloads All The Things
	- https://github.com/swisskyrepo/PayloadsAllTheThings
- Mythic C2 framework
	- https://github.com/its-a-feature/Mythic
- Nishang
	- https://github.com/samratashok/nishang
- Darkarmour
	- https://github.com/bats3c/darkarmour

## Payload transfer and execution
- Impacket
	- deal with psexec, smbclient, wmi, Kerberos, ability to stand up SMB server
- Payloads All The Things (see above)
	- find quick one liners to help tranfser files across hosts expediently
- SMB
	- easy way to exploit route to transfer files between hosts
- RCE via metasploit
- Other protocols

## Steps
1. Enumerate host
	- nmap -v -A IP
2. MSF auxiliary check
3. Search for exploit and run

# Which Windows shell to use
- CMD vs Powershell
- Use CMD when:
	- You are on an older host that may not include PowerShell.
	- When you only require simple interactions/access to the host.
	- When you plan to use simple batch files, net commands, or MS-DOS native tools.
	- When you believe that execution policies may affect your ability to run scripts or other actions on the host.
- Use PowerShell when:
	- You are planning to utilize cmdlets or other custom-built scripts.
	- When you wish to interact with .NET objects instead of text output.
    - When being stealthy is of lesser concern.
    - If you are planning to interact with cloud-based services and hosts.
    - If your scripts set and use Aliases.