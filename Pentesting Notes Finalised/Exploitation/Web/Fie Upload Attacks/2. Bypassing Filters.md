# Client-Side validations
## Back End Request modification
- Use BURP, capture the POST request being sent to say `/upload.php`, then modify this request
	- The POST request is automatically sent **AFTER** a **valid request** to upload a legit image (which passes the front end verification), for example
	- Add the Webshell one-liner directly in the POST request

## Disabling Front End validation
- Check the source code through devtools, find the function that checks for images only
	- Check the html for the js functions that do the check, then modify the js (and html if needed)
		- html under elements, js under sources
		- for js, remember to Ctrl+s to save.
- Remember, after uploading webshell, still need to find the correct path to it
	- Check html with devtools again. 
		- eg. if was submitted as a profile pic, and profile pic is retained, might be able to see directory to web shell with html

# Blacklist filters
- Backend might have a blacklist of certain extension types
eg.
```
$fileName = basename($_FILES["uploadFile"]["name"]);
$extension = pathinfo($fileName, PATHINFO_EXTENSION);
$blacklist = array('php', 'php7', 'phps');

if (in_array($extension, $blacklist)) {
    echo "File type not allowed";
    die();
}
```

- Vulnerable since many extensions not included in this list
- Also, this particular one is not case snsitive whereas Windows servers, file names case insensitive

## Fuzzing Extensions
- /SecLists/blob/master/Discovery/Web-Content/web-extensions.txt
- Fuzz with Burpsuite
	- Start with a  `.php` request to upload, then FUZZ see what we get
	- Remember to change the extension from the filename section in Content-Disposition, **not Content-type**
- Of course, will still need the extension type be able to execute php.
- Then just add the PHP one liner web shell in the POST request, change the filename extension to the one we found and so on

# Whitelist filters
- Whitelisted backend can also be vulnerable if not done properly
eg.
```php
$fileName = basename($_FILES["uploadFile"]["name"]);

if (!preg_match('^.*\.(jpg|jpeg|png|gif)', $fileName)) {
    echo "Only images are allowed";
    die();
}
```

- Regex used, but vulnerable as it only checks whether the file name **contains** the extension and not if it **ends** with it.
- Double extension
	- Same as the 'changing extension' method from the blacklist section, but just change the filename to something like `shell.jpg.php`
		- It contains `jpg` so accepted

