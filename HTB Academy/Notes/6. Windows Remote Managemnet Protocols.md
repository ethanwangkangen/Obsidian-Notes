Main components
- Remote Desktop Protocol (RDP)
- Windows Remote Management (WinRM)
- Windows Management Instrumentation (WMI)

# RDP
- Important ports
	- TCP 3389, can use UDP too
- For remote access to computer running Windows OS
- For RDP session, both network firewall and firewall of server must allow connections from outside
	- If Network Address Translation (NAT) used on route between client and server, remote needs the public IP address to reach the server, and port forwarding must be set up on the NAT router
- TLS/SSL available, but many Windows systems do not insist on this, accept inadequate encryption via RDP security
	- Even with TLS, identity-proving certs are self-signed, so can forge
- Remote Desktop service installed by default on Windows servers
	- Activated by Server Manager
	- By default allows connections to service only to hosts with Network Level Authentication (NLA)

Scanning
- `nmap -sV -sC ip -p 3389 --script rdp*`
- with --packet-trace
	- can see individual packages and contents
	- see that RSP cookies (mstshash=nmap) used by Nmap to interact with RDP server can be identified by threat hunters and various security services like Endpoint Detection and Response (EDR)
		- lock us out
- rdp-sec-check.pl
	- `sudo cpan`
	- `git clone https://github.com/CiscoCXSecurity/rdp-sec-check.git && cd rdp-sec-check`
	- `./rdp-sec-check.pl 10.129.201.248`

Authentication and connection to RSP servers
- xfreedp
	- `xfreerdp /u:cry0l1t3 /p:"P455w0rd!" /v:10.129.201.248`
- rdesktop
- Remmina


# WinRM
- Important ports
	- 5985, 5986 (https)
	- uses Simply Object Access Protocol (SOAP) to establish connections to remote hosts and their applcations
- Windows Remote Shell (WinRS)
	- Allows execution of arbitrary commands on remote system
- Scanning
	- nmap
	- can check if one or more remote servers can be reached via WinRM with PowerShell
		- Test-WsMan cmdlset
		- For Linux: evil-winrm
			- `evil-winrm -i 10.129.201.248 -u Cry0l1t3 -p P455w0rD!



# WMI
- Important ports
	- 135
- Implementation/extension of Common Information odel (CIM)
- Allows read and write access to almost all settings on Windows systems

Footprinting
- Initialisation of WMI communication always on 135, then moved to random port
	- `/usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:"P455w0rD!"@10.129.201.248 "hostname"
`