# Whois
- Details about domain
	- `whois inlanefreight.com`
- Information
	- Domain registration
		- Registrar
		- Creation date
		- Expiry date
	- Domain owner
		- Registrant/admin/tech organisation
	- Domain status
		- clientDeleteProhibited...
	- Name servers


# DNS
- See [[2. Application - DNS]]

## Subdomain 
- Enumeration
	- Active
		- Attempting DNS zone transfer
		- Brute force enumeration
			- Dnsenum
			- Ffuf
			- Gobuster
	- Passive
		- Certificate Transparency (CT) logs 
			- Public repositories of SSL/TLS certificates
		- Googling
			- Specialised search operations (eg, site:)

## Tools
dnsenum
- dns record enumeration
- zone transfer attempts
- subdomain brute forcing
- google scraping
- reverse lookup
- whois lookups
- `dnsenum --enum inlanefreight.com -f /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -r`
	- -r: recursive brute forcing
	- 

## Zone transfer
- Copy of all DNS records within a zone from one name server to another
- `dig axfr @nsztm1.digi.ninja zonetransfer.me
	- Request a one transfer from nsztm1.di.ninja for tthe zonetransfer.me domain

# Virtual Hosts
- Configurations within a web server that allow multiple websites or applications to be hosted on single server
- React to 'host' section in HTTP request
- Important: If virtual host does not have a DNS record, can just access it via modifying /etc/hosts, mapping that domain name to an IP

Discovery
- Manual analysis of HTTP headers
- Reverse DNS lookups
- Tools
	- gobuster
	- Feroxbuster
	- ffuf

Go buster
- 1. Need to identify target IP, can be done thorugh DNS lookup or otherwise
- 2. Wordlist preparation
- gobuster vhost -u http://<target_IP_address> -w <wordlist_file> --append-domain
	- eg.
	- gobuster vhost -u http://inlanefreight.htb:81 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --append-domain

# Certificate Transparency Logs
- Public, append-only ledgers that record issuance of SSL/TLS certificates
- Global registry of certifcates
- Provide definitive record of certificates issued for a domain and its subdomain

Searching CT logs
- crt.sh
	- `curl -s "https://crt.sh/?q=facebook.com&output=json" | jq -r '.[] | select(.name_value | contains("dev")) | .name_value' | sort -u
		- fetches JSON output from crt.sh for erts matching domain facebook.com
		- jq .. -> filters for entries where name_value field (contianing domain/subdomain) includes the string 'dev'
		- sort -u: sorts alphabetically and removes duplicates

- Censys

# Fingerprinting
- Banner grabbing
	- curl the url
- Analysing HTTP headers
	- Server header typically discloses web server software, X-Powered-By header might reveal additional technologies like scripting languages or frameworks
- Probing for specific responses
- Analysing page content

Tools

| Tool         | Description                                                                                                           | Features                                                                                            |
| ------------ | --------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- |
| `Wappalyzer` | Browser extension and online service for website technology profiling. Command line: npx wappalyzer                   | Identifies a wide range of web technologies, including CMSs, frameworks, analytics tools, and more. |
| `BuiltWith`  | Web technology profiler that provides detailed reports on a website's technology stack.                               | Offers both free and paid plans with varying levels of detail.                                      |
| `WhatWeb`    | Command-line tool for website fingerprinting.                                                                         | Uses a vast database of signatures to identify various web technologies.                            |
| `Nmap`       | Versatile network scanner that can be used for various reconnaissance tasks, including service and OS fingerprinting. | Can be used with scripts (NSE) to perform more specialised fingerprinting.                          |
| `Netcraft`   | Offers a range of web security services, including website fingerprinting and security reporting.                     | Provides detailed reports on a website's technology, hosting provider, and security posture.        |
| `wafw00f`    | Command-line tool specifically designed for identifying Web Application Firewalls (WAFs).                             | Helps determine if a WAF is present and, if so, its type and configuration.                         |
WafwOOf
-  pip3 install git+https://github.com/EnableSecurity/wafw00f
- wafw00f example.com
- Used to identify Web Application Firewalls (WAFs)

Nikto
- Open source web server scanner
- sudo apt update && sudo apt install -y perl
- git clone https://github.com/sullo/nikto
- cd nikto/program
- chmod +x ./nikto.pl
- nikto -h inlanefreight.com -Tuning b
	- -h to specify host
	- -Tuning b -> only run Software Identification modules


Example question
- Target IP given
- vhosts required:
	- app.inlanefreight.local
	- dev.inlanefreight.local
- this means that these both run on the same server (and the same port serves http server), but respond differently depending on host header
- so we need to add entries to /etc/hosts
	- `<IP> app.inlanefreight.local`
- banner grabbing for apache version
	- curl -I IP

# Web crawling
- Starts with see URL
- Crawler fetches the page, parses content, extracts all links
- Then adds links to queue and crawls them
- Breadth-first vd depth-first crawling
- Information possible gathered
	- links
	- comments
	- metadata
		- eg. page titles, descriptions,...
	- sensitive files,...
		- backup files (eg. .back, .old)
		- config files (web.config, settings.php)
		- log files (error_log, access_log)
- Context is important

# robots.txt
- File placed in root directory of website, eg. www.example.com/robots.txt
- Specifies which URLS that crawlers are not allowed to view

# Well-known URIs
- Standardized directory within website's root domain
- Usually accessible via /.well-known/ path on web server
- Allows clients (like browsers, apps, APIs) to automatically discover information or resources without needing to guess or rely on documentation

- **Security / Authentication**
    - `/.well-known/security.txt` → lists how to report security vulnerabilities.
    - `/.well-known/openid-configuration` → metadata for OpenID Connect.
    - `/.well-known/oauth-authorization-server` → OAuth2 discovery.
- **Web Services**
    - `/.well-known/host-meta` → WebFinger and federated identity lookups.
    - `/.well-known/apple-app-site-association` → iOS universal link configuration.
- **Cryptography**
    - `/.well-known/change-password` → redirects users to a password reset page.
    - `/.well-known/keybase.txt` → proves domain ownership for Keybase.

openid-configuration
- When client wants to use OpenID Connect for authentication, can retrieve the OpenID Connect Provider's configuration by accessing the .../.well-known/open-d-configuration endpoint
	- endpoint returns a json document containing metadata about provider's endpoints, supported authentication methods, token issuance and more

The information obtained from the `openid-configuration` endpoint provides multiple exploration opportunities:

1. `Endpoint Discovery`:
    - `Authorization Endpoint`: Identifying the URL for user authorization requests.
    - `Token Endpoint`: Finding the URL where tokens are issued.
    - `Userinfo Endpoint`: Locating the endpoint that provides user information.
2. `JWKS URI`: The `jwks_uri` reveals the `JSON Web Key Set` (`JWKS`), detailing the cryptographic keys used by the server.
3. `Supported Scopes and Response Types`: Understanding which scopes and response types are supported helps in mapping out the functionality and limitations of the OpenID Connect implementation.
4. `Algorithm Details`: Information about supported signing algorithms can be crucial for understanding the security measures in place.


# Web Scrapers
Popular web crawlers
- Burp Suite Spider
- Owasp ZAP (Zed Attack Proxy)
- Scrapy (Python Framework)
- Apache Nutch (Scalable Crawler)

Scrapy
- pip3 install scrapy
- wget -O ReconSpider.zip https://academy.hackthebox.com/storage/modules/144/ReconSpider.v1.2.zip
-  unzip ReconSpider.zip 
- python3 ReconSpider.py http://example.com

# Search Engine Discovery

Important Search Operators

|Operator|Operator Description|Example|Example Description|
|:--|:--|:--|:--|
|`site:`|Limits results to a specific website or domain.|`site:example.com`|Find all publicly accessible pages on example.com.|
|`inurl:`|Finds pages with a specific term in the URL.|`inurl:login`|Search for login pages on any website.|
|`filetype:`|Searches for files of a particular type.|`filetype:pdf`|Find downloadable PDF documents.|
|`intitle:`|Finds pages with a specific term in the title.|`intitle:"confidential report"`|Look for documents titled "confidential report" or similar variations.|
|`intext:` or `inbody:`|Searches for a term within the body text of pages.|`intext:"password reset"`|Identify webpages containing the term “password reset”.|
|`cache:`|Displays the cached version of a webpage (if available).|`cache:example.com`|View the cached version of example.com to see its previous content.|
|`link:`|Finds pages that link to a specific webpage.|`link:example.com`|Identify websites linking to example.com.|
|`related:`|Finds websites related to a specific webpage.|`related:example.com`|Discover websites similar to example.com.|
|`info:`|Provides a summary of information about a webpage.|`info:example.com`|Get basic details about example.com, such as its title and description.|
|`define:`|Provides definitions of a word or phrase.|`define:phishing`|Get a definition of "phishing" from various sources.|
|`numrange:`|Searches for numbers within a specific range.|`site:example.com numrange:1000-2000`|Find pages on example.com containing numbers between 1000 and 2000.|
|`allintext:`|Finds pages containing all specified words in the body text.|`allintext:admin password reset`|Search for pages containing both "admin" and "password reset" in the body text.|
|`allinurl:`|Finds pages containing all specified words in the URL.|`allinurl:admin panel`|Look for pages with "admin" and "panel" in the URL.|
|`allintitle:`|Finds pages containing all specified words in the title.|`allintitle:confidential report 2023`|Search for pages with "confidential," "report," and "2023" in the title.|
|`AND`|Narrows results by requiring all terms to be present.|`site:example.com AND (inurl:admin OR inurl:login)`|Find admin or login pages specifically on example.com.|
|`OR`|Broadens results by including pages with any of the terms.|`"linux" OR "ubuntu" OR "debian"`|Search for webpages mentioning Linux, Ubuntu, or Debian.|
|`NOT`|Excludes results containing the specified term.|`site:bank.com NOT inurl:login`|Find pages on bank.com excluding login pages.|
|`*` (wildcard)|Represents any character or word.|`site:socialnetwork.com filetype:pdf user* manual`|Search for user manuals (user guide, user handbook) in PDF format on socialnetwork.com.|
|`..` (range search)|Finds results within a specified numerical range.|`site:ecommerce.com "price" 100..500`|Look for products priced between 100 and 500 on an e-commerce website.|
|`" "` (quotation marks)|Searches for exact phrases.|`"information security policy"`|Find documents mentioning the exact phrase "information security policy".|
|`-` (minus sign)|Excludes terms from the search results.|`site:news.com -inurl:sports`|Search for news articles on news.com excluding sports-related content.|

### Google Dorking

Google Dorking, also known as Google Hacking, is a technique that leverages the power of search operators to uncover sensitive information, security vulnerabilities, or hidden content on websites, using Google Search.

Here are some common examples of Google Dorks, for more examples, refer to the [Google Hacking Database](https://www.exploit-db.com/google-hacking-database):

- Finding Login Pages:
    - `site:example.com inurl:login`
    - `site:example.com (inurl:login OR inurl:admin)`
- Identifying Exposed Files:
    - `site:example.com filetype:pdf`
    - `site:example.com (filetype:xls OR filetype:docx)`
- Uncovering Configuration Files:
    - `site:example.com inurl:config.php`
    - `site:example.com (ext:conf OR ext:cnf)` (searches for extensions commonly used for configuration files)
- Locating Database Backups:
    - `site:example.com inurl:backup`
    - `site:example.com filetype:sql`

# Web archives
- https://web.archive.org

# Automating recon
Frameworks
- FinalRecon
- Recon-ng
- theHarvester
- SpiderFoot
- OSINT frameworks

FinalRecon
- Header Information
	- Server details, tech used, potential security misconfigurations
- Whois lookup
	- Domain registration details
- SSL cert info
- Crawler
	- HTML, CSS, JS
	- Internal/External Linls
	- Images, robots.txt, sitemap.xml..
	- Links in JS, Wayback machine
- DNS enumeration
- Subdomain enumeration
- Directory enumeration
- Wayback machine

git clone https://github.com/thewhiteh4t/FinalRecon.git
cd FinalRecon
pip3 install -r requirements.txt
chmod +x ./finalrecon.py
./finalrecon.py --help
	- to show options

Example 
- Target: 94.237.57.211:43292
- vHosts needed for the question: inlanefreight.htb
	- Add to localhosts. Don't include the port!
- Banner grabbing
	- curl -I inlanefreight.htb:43292
		- get server software
- whois lookup (read question carefully! ask for .com not .htb)
	- whois inlanefreight.com
		- get IANA ID
- gobust in vhost to get subdomain web1337.inlanefreight.htb
	- add this to /etc/hosts !
	- gobuster vhost -u http://<target_IP_address> -w <wordlist_file> --append-domain
- then gobust that subdomain to go even deeper
	- found dev.web1337.inlanefreight.htb
	- again, add this to /etc/hosts
	- then scrape this with scrapy 
- then brute force paths/directories
	- gobuster in dir mode (not vhosts mode)
	- gobuster dir -u http://web1337.inlanefreight.htb:31324 --wordlist /usr/share/seclists/Discovery/Web-Content/common.txt 
	- found: index.html, robots.txt
- http://web1337.inlanefreight.htb:31324/robots.txt
	- found: disallow: /admin_h1dd3n
- then 
	- http://web1337.inlanefreight.htb:31324/admin_h1dd3n/
	- make sure browser doesn't reformat this!


Key point: subdomain enumeration is recurrent

{
    "emails": [
        "1337testing@inlanefreight.htb"
    ],
    "links": [
        "http://dev.web1337.inlanefreight.htb:46473/index-531.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-291.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-463.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-302.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-938.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-561.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-553.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-224.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-755.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-918.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-247.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-949.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-737.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-134.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-988.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-555.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-567.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-581.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-727.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-643.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-459.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-105.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-948.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-817.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-437.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-631.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-728.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-687.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-244.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-989.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-525.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-799.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-80.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-895.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-798.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-734.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-626.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-332.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-933.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-326.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-748.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-334.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-815.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-577.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-888.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-733.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-1000.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-615.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-350.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-226.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-789.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-504.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-465.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-964.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-254.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-807.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-166.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-203.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-635.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-641.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-300.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-939.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-335.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-458.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-220.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-947.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-379.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-202.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-408.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-714.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-342.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-204.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-977.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-385.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-769.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-944.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-472.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-189.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-785.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-513.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-925.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-431.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-329.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-795.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-292.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-585.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-248.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-760.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-364.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-114.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-862.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-165.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-77.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-909.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-24.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-660.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-574.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-403.html",
        "http://dev.web1337.inlanefreight.htb:46473/index-384.html"
    ],
    "external_files": [],
    "js_files": [],
    "form_fields": [],
    "images": [],
    "videos": [],
    "audio": [],
    "comments": [
        "<!-- Remember to change the API key to ba988b835be4aa97d068941dc852ff33 -->"
    ]
