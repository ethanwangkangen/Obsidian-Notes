# Must-know topics

## HTTP request/response cycle
- HTTP is stateless, text-based protocol. 
- Client sends requests, server return responses
- Stateless, so security mechanism must either ber stored
	- Client side -> cookies, tokens
	- Server side -> session ID
- Use BurpSuite to identify how requests are constructed
	- Eg. Pressing this button sends a POST request with and id sent as a json parameter, or perhaps is a GET request with id as data parameter...

## Headers 
- Host
	- Specifies target virtual host
		- Recap: virtual host: same ip, but different response to client based on this header
	- Vulnerabilites:
		- Host header injection
		- Password reset poisoning
		- SSRF
		- Cache poisoning
- User-Agent
	- Client identifier
		- Can be manipulated for WAF bypass
		- Eg. SQLMap, flag available to change User-Agent 
- Cookie
	- Carries state/session.
	- Server gives the client a cookie to use in future requests
- Set-Cookie
	- Server to client, commanding browser to store the ccookie
- Origin
	- Identifies where a request originated (scheme + host + port)
	- Used for CSRF defences and CORS
- Referer
	- Useful for CSRF but can be spoofed
- Content-type
	- Indicates how body is formatted
	- Can be abused in file upload bypasses
		- Eg. `image/png` but actually a webshell
	- Influences how servers parse requests

## Cookies vs sessions
- Cookies
	- Stored on client
	- Sent automatically with each request
	- Can contain session IDs, preferences, JWTs
	- Security attributes: HttpOnly, Secure, SameSite, Path
- Session
	- Stored on server
	- Identified by session ID stored in a cookie
- Implications
	- Session fixation
		- Attacker forces victim to use session ID chosen by attacker before login
	- Session hijacking (XSS, sniffing)
		- XSS steals cookie, sniffs unencrypted HTTP traffic
		- Weak cookie flags, eg. HttpOnly missing, JS can steal. Secure missing, HTTP sniffing
	- Weak cookie attributes -> CSRF/XSS exploitation
	- JWT sessions -> need strong signing, expiry
		- JSON Web Token, stored in Cookies usually
		- Must be cryptographically signed so cannot be m odified

## TLS handshake basics (certificates, public key crypto)
- Flow:
	- Client hello, TLS versions/cipher suite
	- Server replies with certificate
		- Matching identitiy with public key
	- Client validates certificate (CA trust)
	- Authenticated Key Exchange
		- Eg. ECDHE, Private Keys used to sign secret
	- Symmetric session keys derived	

- DNS (A, AAAA, CNAME, MX, SRV records)
- SameSite cookie attribute
- URL encoding
- REST vs SOAP basics

# Typical Questions

**Q: What happens when you type a URL into the browser?**  
**Q: Explain the TLS handshake.**  
**Q: What is DNS used for?**  
**Q: What is an SRV record and why does AD use it?**