
| Protocol / Tool                     | Command / Syntax                                                                                                                                                                                                                           | Purpose / Notes                                                                                    |
| ----------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------- |
| System info                         | `Get-ComputerInfo \| Select CsName, WindowsProductName, WindowsVersion, OsArchitecture`                                                                                                                                                    | Quick host summary (OS, architecture). Useful first step.                                          |
| Local users                         | `Get-LocalUser \| Select-Object Name, Enabled, LastLogon`                                                                                                                                                                                  | Enumerate local accounts. Requires PowerShell 5+.                                                  |
| Local groups & members              | `Get-LocalGroup \| ForEach-Object { $_.Name; Get-LocalGroupMember -Name $_.Name }`                                                                                                                                                         | See group membership (e.g. Administrators).                                                        |
| Running processes                   | `Get-Process \| Sort-Object CPU -Descending \| Select-Object -First 10 Id, ProcessName, CPU`                                                                                                                                               | Top CPU consumers; spot suspicious processes.                                                      |
| Services (running)                  | `Get-Service \| Where-Object {$_.Status -eq 'Running'} \| Select Name, DisplayName`                                                                                                                                                        | Enumerate services; useful to find misconfigured or unusual services.                              |
| Listening ports                     | `Get-NetTCPConnection -State Listen \| Select-Object LocalAddress,LocalPort,OwningProcess`                                                                                                                                                 | Find listening TCP ports and owning PID (modern replacement for `netstat`).                        |
| Active connections                  | `Get-NetTCPConnection \| Where-Object {$_.State -eq 'Established'} \| Select LocalAddress,LocalPort,RemoteAddress,RemotePort,State`                                                                                                        | See active network connections.                                                                    |
| DNS / name resolution               | `Resolve-DnsName example.com -Type A`                                                                                                                                                                                                      | Perform DNS lookups from the host (check internal DNS).                                            |
| Test remote port                    | `Test-NetConnection -ComputerName 10.0.0.5 -Port 3389` or `Test-Port` helper below                                                                                                                                                         | Quick port reachability and basic traceroute info.                                                 |
| Simple TCP port helper              | `function Test-Port { param($h,$p,$t=2000); try{$s=New-Object Net.Sockets.TcpClient;$a=$s.BeginConnect($h,$p,$null,$null); if($a.AsyncWaitHandle.WaitOne($t)){ $s.EndConnect($a); $s.Close(); $true } else { $false }} catch { $false }} ` | Small function to check if a host:port is open (useful when `Test-NetConnection` unavailable).     |
| **File search (interesting files)** | **`Get-ChildItem -Path C:\ -Recurse -ErrorAction SilentlyContinue -Include *.config,*.xml,*.ini \| Select-Object FullName, LastWriteTime`**                                                                                                | Find configuration files quickly (adjust patterns). Beware of long scansâ€”target folders first.     |
| Find large files                    | `Get-ChildItem -Path C:\ -Recurse -File -ErrorAction SilentlyContinue \| Where-Object {$_.Length -gt 50MB} \| Select FullName,@{n='MB';e={[math]::Round($_.Length/1MB,1)}}`                                                                | Locate large artefacts (logs, DBs) that may contain useful context.                                |
| Search inside files (like grep)     | `Select-String -Path "C:\inetpub\logs***.log" -Pattern "password"`<br>                                                                                                                                                                     | Quick textual search across files; supports regex and context.                                     |
| Scheduled tasks                     | `Get-ScheduledTask \| Select TaskName, State, LastRunTime`                                                                                                                                                                                 | See scheduled tasks; useful for persistence checks or routine jobs.                                |
| Event logs (recent errors)          | `$since=(Get-Date).AddHours(-24); Get-WinEvent -FilterHashtable @{LogName='Application'; StartTime=$since} \| Where-Object {$_.LevelDisplayName -eq 'Error'} \| Select TimeCreated, Id, ProviderName, Message`                             | Pull recent errors for triage. Use Security log queries only with appropriate permissions.         |
| Export results                      | `<cmd> \| Export-Csv -Path report.csv -NoTypeInformation`                                                                                                                                                                                  | Save findings for later analysis (e.g. `Get-Process \| Export-Csv`).                               |
| **Remote exec (WinRM)**             | **`Invoke-Command -ComputerName host1 -ScriptBlock { hostname; whoami } -Credential (Get-Credential)`**                                                                                                                                    | Run authorised commands remotely if WinRM configured. Mention privilege requirements in interview. |
| Copy file (SMB)                     | `Copy-Item -Path .\report.txt -Destination "\\host\C$\Temp\report.txt" -Credential (Get-Credential)`                                                                                                                                       | Transfer a file over an SMB share (requires access).                                               |
| **Download file (HTTP)**            | **`Invoke-WebRequest -Uri 'https://example.com/tool.exe' -OutFile 'C:\Temp\tool.exe'`**                                                                                                                                                    | Pull files from webserver (use only trusted sources).                                              |
| REST API interaction                | `Invoke-RestMethod -Uri '[https://api.local/scan](https://api.local/scan)' -Method Post -Body (@{target='10.0.0.5'} ConvertTo-Json) -ContentType 'application/json'`                                                                       | Automate internal APIs or orchestration services.                                                  |
| Quick help & discovery              | `Get-Help Get-Process -Full` and `Get-Command -Module Microsoft.PowerShell.Management`                                                                                                                                                     | Learn cmdlet usage and discover available commands on the target.                                  |
| Safe interactive filter             | `<cmd> \| Out-GridView`                                                                                                                                                                                                                    | Pop up interactive table to filter results (useful during triage on a desktop).                    |
